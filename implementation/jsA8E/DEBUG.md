# Debug

- Files: `jsA8E/js/app/ui.js`, `jsA8E/js/core/atari.js`, `jsA8E/js/core/app_proxy.js`, `jsA8E/emulator_worker.js`, `jsA8E/js/render/gl.js`, `jsA8E/js/core/cpu.js`, `jsA8E/js/core/hostfs.js`, `jsA8E/index.html`
- Purpose: document browser (`jsA8E/`) debug/diagnostic hooks, error-reporting paths, and current runtime limits.
- Status: verified on 2026-02-23 (`implemented`, with usability limits below).
- Notes: an optional CPU register overlay path exists: `ui.js` reads `debugEl` from `#debug`, and `atari.js` writes `PC/A/X/Y/SP/P` via `updateDebug()` (per painted frame, reset, and initial paint). In the shipped UI, `index.html` has no `#debug` element, so this overlay is inactive by default. In worker mode, `debugEl` is explicitly `null` (`emulator_worker.js`), so the overlay is unavailable there too. Worker diagnostics are active: worker-side failures are wrapped as `{ type: "error", message }`, forwarded to main-thread proxy, and logged via `console.error` (`app_proxy.js`), with `worker.onerror` as an additional failure path. Rendering diagnostics are exception-driven: `gl.js` throws detailed shader/program/framebuffer errors; both main-thread and worker init paths catch WebGL setup failures and fall back to 2D canvas. Additional console diagnostics include keyboard CSS scaling mismatch warning (once), file/auto-load errors, and H: host filesystem listener/IndexedDB init errors. CPU PC hooks (`setPcHook` / `clearPcHook` in `cpu.js`) are available and used by `atari.js` for H: CIO interception; these hooks are also the primary low-level entry point for targeted tracing/tests.
- Issues: no built-in visible debug panel in default HTML, no runtime disassembly view, and no unified in-app diagnostics UI; most diagnostics are console-only. Worker diagnostics are visible in devtools but not surfaced in emulator UI state.
- Todo: add a visible debug panel toggle (`#debug`) and worker-compatible status channel; expose worker/render backend and last error in UI; add optional runtime log categories to reduce reliance on ad-hoc console output.
